name: CI Pipeline - BÃ i 6

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  build:
    name: Build vÃ  Test
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Láº¥y code tá»« GitHub
        uses: actions/checkout@v3

      - name: â˜• CÃ i Ä‘áº·t Java 11
        uses: actions/setup-java@v3
        with:
          java-version: '11'
          distribution: 'temurin'

      - name: ğŸ“‚ Xem cáº¥u trÃºc thÆ° má»¥c
        run: |
          echo "=== Cáº¤U TRÃšC THÆ¯ Má»¤C ==="
          ls -la
          echo ""
          echo "=== THÆ¯ Má»¤C SRC ==="
          ls -la src/com/example/ || echo "KhÃ´ng tÃ¬m tháº¥y src/com/example/"
          echo ""
          echo "=== THÆ¯ Má»¤C TEST ==="
          ls -la test/com/example/ || echo "KhÃ´ng tÃ¬m tháº¥y test/com/example/"
          echo ""
          echo "=== THÆ¯ Má»¤C LIB ==="
          ls -la lib/ || echo "KhÃ´ng tÃ¬m tháº¥y lib/"

      - name: ğŸ“ Táº¡o thÆ° má»¥c output
        run: |
          mkdir -p out
          mkdir -p test-out

      - name: ğŸ”¨ BiÃªn dá»‹ch code chÃ­nh
        run: |
          echo "Äang biÃªn dá»‹ch code chÃ­nh..."
          javac -cp "lib/*" -d out src/com/example/*.java
          echo "âœ… BiÃªn dá»‹ch code chÃ­nh thÃ nh cÃ´ng"

      - name: ğŸ”§ BiÃªn dá»‹ch test
        run: |
          echo "Äang biÃªn dá»‹ch test..."
          javac -cp "lib/*:out" -d test-out test/com/example/*.java
          echo "âœ… BiÃªn dá»‹ch test thÃ nh cÃ´ng"

      - name: ğŸ§ª Cháº¡y test
        run: |
          echo "Äang cháº¡y test..."
          java -cp "lib/*:out:test-out" org.junit.runner.JUnitCore com.example.CalculatorTest
          echo "âœ… Táº¥t cáº£ test passed!"

      - name: ğŸ“¦ ÄÃ³ng gÃ³i á»©ng dá»¥ng
        if: success()
        run: |
          echo "Äang Ä‘Ã³ng gÃ³i..."
          jar -cf calculator-bai6.jar -C out .
          echo "âœ… ÄÃ£ táº¡o file calculator-bai6.jar"